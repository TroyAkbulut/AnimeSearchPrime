{% load static %}
<html lang="en">
    <head>
        <link rel="stylesheet" href="{% static '9anime.css' %}?v=1.3">
        <link rel="stylesheet" href="{% static 'style.css' %}?v=1.6">
        <link rel="stylesheet" href="{% static 'login_styles.css' %}?v=1.3">
        <meta charset="UTF-8">
        <title>Login</title>
    </head>

    <body>
        {% include 'navbar.html' %}

        <div class="forms-container">
            <form class="login_form" onSubmit="return ValidateLogin(this);" action="{% url 'login' %}" method="post">
                {% csrf_token %}
                <h1>Login</h1>
                {% if loginErrors %}
                    <div class="alert alert-danger" role="alert">
                        Login failed:
                        <ul class="error-list">
                        {% for error in loginErrors %}
                            <li>
                                {{ error }}
                            </li>
                        {% endfor %}
                        </ul>
                    </div>
                {% endif %}
                <input name="loginUsername" class="login-input" type="text" placeholder="Username" oninput="this.setCustomValidity('')">
                <input name="loginPassword" class="login-input" type="password" placeholder="Password" oninput="this.setCustomValidity('')">
                <input class="btn-search" type="submit" value="Login">
            </form>
            <div class="vl">
                <div></div>
                <div></div>
                <div></div>
            </div>
            <form class="login_form" onSubmit="return ValidateRegister(this);" action="{% url 'register' %}" method="post">
                {% csrf_token %}
                <h1>Register</h1>
                {% if registerErrors %}
                    <div class="alert alert-danger" role="alert">
                        Could not create account:
                        <ul class="error-list">
                        {% for error in registerErrors %}
                            <li>
                                {{ error }}
                            </li>
                        {% endfor %}
                        </ul>
                    </div>
                {% endif %}
                <input name="registerUsername" class="login-input" type="text" placeholder="Username" oninput="this.setCustomValidity('')">
                <input name="registerEmail" class="login-input" type="email" placeholder="Email" oninput="this.setCustomValidity('')">
                <input name="registerPassword" class="login-input" type="password" placeholder="Password" oninput="this.setCustomValidity('')">
                <input name="registerConfirmPassword" class="login-input" type="password" placeholder="Confirm Password" oninput="this.setCustomValidity('')">
                <input class="btn-search" type="submit" value="Register">
            </form>
        </div>
    </body>

    <script>
        function ValidateRegister(form) {
            valid = true;
            
            username = form.registerUsername;
            email = form.registerEmail;
            password = form.registerPassword;
            confirmPassword = form.registerConfirmPassword;

            if (username.value == null || username.value.trim() === ""){
                username.setCustomValidity("Username cannot be empty")
                valid = false;
            }

            if (email.value == null ||email.value.trim() === ""){
                email.setCustomValidity("Email cannot be empty")
                valid = false;
            }

            if (password.value == null ||password.value.trim() === ""){
                password.setCustomValidity("Password cannot be empty")
                valid = false;
            }

            if (password.value != confirmPassword.value) {
                confirmPassword.setCustomValidity("Password does not match")
                valid = false;
            }

            form.reportValidity()

            return valid;
        }

        function ValidateLogin(form) {
            valid = true;
            
            username = form.loginUsername;
            password = form.loginPassword;

            if (username.value == null || username.value.trim() === ""){
                username.setCustomValidity("Please enter a username")
                valid = false;
            }

            if (password.value == null ||password.value.trim() === ""){
                password.setCustomValidity("Please enter a password")
                valid = false;
            }

            form.reportValidity()

            return valid;
        }
    </script>

</html>